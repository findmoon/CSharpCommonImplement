**.NET性能优化：你应该知道的每件事【译】**

[toc]

> 原文 [.NET Performance Optimization: Everything You Need To Know](https://stackify.com/net-application-optimization/)

现在是星期五下午，大多数开发人员已经收拾好行李，准备回家过周末，但你仍然需要留意应用到生产的最新的修补程序。令你沮丧的是，部署一完成，队列就开始备份，并且开始从监视系统收到警报。某些内容已损坏(`broken`)，所有证据都指向应用程序性能瓶颈（`performance bottleneck`）。

**==我们可以做什么阻止性能不佳的代码应用到生产环境？==**

对于开发人员和软件团队经理（管理者）来说，这种体验太常见了。我们可以做些什么来防止性能不佳的代码进入生产环境，并防止我们的“保证 0% 停机时间”平台在生产量高负载下瘫痪？

> “guaranteed 0% downtime” platform

答案在于适当的预生产流程(`pre-production processes`)，以验证我们的更改没有对性能产生实质性的负面影响。

在本文中，我提出了一个优化 .Net 性能的工作流 - 测量性能、诊断潜在问题和验证改进的有效性（`measuring performance、diagnosing potential issues 和 validating the efficacy of improvements.`）。这是一个发现、分析、重构、测试、基准测试和监视的迭代过程（`discovery, profiling, refactoring, testing, benchmarking, and monitoring`）。

本文中使用的示例应用程序可以在 [GitHub](https://github.com/jaredcnance/FuzzySearch) 上找到。

# 代码审查 - Code Reviews

**==执行代码审查是在代码进入生产环境之前保持对代码的质量控制的重要组成部分。==**

代码审查允许你的团队成员通读你的代码更改，并根据他们的最佳判断、批准(审批)或建议对你的工作进行更改。这也有助于整个团队跟上对他们来说比较重要的所有的变化。

但是，代码审查会占用其他工程师的时间，有时可能不如预期的那么彻底。

评审的彻底性很少传达给团队，因此审批可能会提供一种虚假的安全感 —— 代码确实可用于生产。

另一个失败点是代码审查很少包含任何类型的定量反馈。换句话说，我可以建议方法 A 比方法 B 更快或分配更少，但我不太可能花时间对我的断言的影响进行定量。

最后，事情只是被错过了。可以独立于使用代码进行更改，审阅者可能不知道正在执行的一组特定于更改的上下文。例如，添加一个简单的一次性字符串串联可能没问题，但如果使用代码对更改的代码进行数百万次迭代，那么我们可能只是引入了一些明显的性能瓶颈。

总之，代码审查是开发过程中不可或缺的一部分。它有助于保持风格一致性、知识转移、开发人员教育和整体质量控制。但是，不应将其视为确保实现不会产生任何不利或越界性能影响的方法。

# 应用程序

本博客文章中使用的示例应用程序可以在 [GitHub](https://github.com/jaredcnance/FuzzySearch) 上找到。它是一个简单的 .NET Core Web API 应用程序。

这篇文章的重点是 `/people?name={name}` 路由。此请求将搜索我们的 People 数据库，并对 name 执行模糊字符串匹配，返回从最相似到最不相似排序的整个列表。

为了简单起见，我们只实现一种匹配算法：[Levenshtein Distance](https://people.cs.pitt.edu/~kirk/cs1501/Pruhs/Spring2006/assignments/editdistance/Levenshtein%20Distance.htm)（编辑距离算法）。

